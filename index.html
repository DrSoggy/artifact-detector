<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Artifact Detector</title>

<style>
html, body {
  margin: 0;
  background: #000;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: "Courier New", monospace;
}

.detector {
  width: 360px;
  background: linear-gradient(#3a2f23, #1c1610);
  border: 8px solid #4b3a2a;
  border-radius: 20px;
  box-shadow: inset 0 0 30px #000;
  padding: 10px;
  position: relative;
}

.screen-wrapper {
  position: relative;
  width: 300px;
  height: 300px;
  margin: auto;
  border-radius: 50%;
  overflow: hidden;
  background: #020;
  box-shadow: inset 0 0 25px #000;
}

canvas {
  width: 100%;
  height: 100%;
}

/* CRT effects */
.screen-wrapper::before {
  content:"";
  position:absolute;
  inset:0;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(0,255,0,0.04),
      rgba(0,255,0,0.04) 1px,
      rgba(0,0,0,0.05) 2px
    );
  pointer-events:none;
}

.screen-wrapper::after {
  content:"";
  position:absolute;
  inset:0;
  background: radial-gradient(circle at top right, rgba(0,0,0,0) 60%, rgba(0,0,0,0.4));
  pointer-events:none;
}

/* Crack */
.crack {
  position:absolute;
  top:10px;
  right:20px;
  width:60px;
  height:60px;
  background: linear-gradient(135deg, rgba(255,255,255,0.25), transparent);
  clip-path: polygon(0 0, 5% 100%, 8% 95%, 12% 100%, 18% 90%, 22% 100%, 100% 20%);
  pointer-events:none;
}

.controls {
  margin-top: 10px;
}

.slider {
  width: 100%;
}

.bottom-row {
  display:flex;
  justify-content: space-between;
  align-items:center;
  margin-top: 6px;
}

.led {
  width: 14px;
  height: 14px;
  background: #400;
  border-radius:50%;
  box-shadow: inset 0 0 4px #000;
}

.green-btn, .power-btn {
  width: 28px;
  height: 28px;
  border-radius:50%;
  border:none;
  box-shadow: inset 0 0 5px #000;
}

.green-btn {
  background:#0a0;
}

.power-btn {
  background: linear-gradient(#c44, #822);
  color:#111;
  font-weight:bold;
}

.stats {
  position:absolute;
  top:12px;
  left:12px;
  font-size:11px;
  background: rgba(0,0,0,0.4);
  padding:6px;
  border:1px solid rgba(0,255,0,0.5);
  display:none;
}

.fake-label {
  position:absolute;
  bottom:6px;
  right:8px;
  font-size:10px;
  color:#6f6;
  opacity:0.4;
}
</style>
</head>

<body>
<div class="detector">
  <div class="screen-wrapper">
    <canvas id="radar" width="300" height="300"></canvas>
    <div class="crack"></div>
    <div class="stats" id="stats"></div>
  </div>

  <div class="controls">
    <input class="slider" id="proximity" type="range" min="0" max="100" value="0">
    <input class="slider" id="direction" type="range" min="0" max="360" value="180">
  </div>

  <div class="bottom-row">
    <div class="led" id="led"></div>
    <button class="power-btn" id="power">ON</button>
    <button class="green-btn" id="random"></button>
  </div>

  <div class="fake-label">ANOMALY LOCATOR MK II</div>
</div>

<audio id="beep" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
<audio id="click" src="https://actions.google.com/sounds/v1/switches/click_01.ogg"></audio>

<script>
const canvas = document.getElementById("radar");
const ctx = canvas.getContext("2d");
const led = document.getElementById("led");
const beep = document.getElementById("beep");
const click = document.getElementById("click");
const statsBox = document.getElementById("stats");

let powerOn = false;
let sweep = 0;
let artifact = {};
let artifactVisible = 0;
let lastBeep = 0;

function randomArtifact() {
  const types = ["Electro","Gravity","Thermal","Bio","Psy","Rad"];
  const rarityRoll = Math.random()*100;
  let rarity, base;

  if (rarityRoll < 60) { rarity="Common"; base=1500; }
  else if (rarityRoll < 90) { rarity="Uncommon"; base=3500; }
  else if (rarityRoll < 99) { rarity="Rare"; base=8000; }
  else { rarity="Legendary"; base=50000; }

  const energy = Math.floor(30 + Math.random()*70);
  const weight = +(0.5 + Math.random()*2).toFixed(2);
  const rads = Math.floor(Math.random()*40);

  let price = base * (1 + energy/200) * (1 + weight/10) * (1 - rads/200);
  price = Math.max(Math.round(price), base);

  artifact = {
    name: ["Tesla","Stone","Spark","Soul","Echo"][Math.floor(Math.random()*5)],
    type: types[Math.floor(Math.random()*types.length)],
    rarity, energy, weight, rads, price
  };
}

randomArtifact();

document.getElementById("random").onclick = () => {
  randomArtifact();
  document.getElementById("proximity").value = 0;
};

document.getElementById("power").onclick = () => {
  powerOn = !powerOn;
  click.play();
};

function draw() {
  requestAnimationFrame(draw);
  ctx.clearRect(0,0,300,300);

  if (!powerOn) return;

  const prox = +proximity.value;
  const dir = (+direction.value + 180) % 360 * Math.PI/180;
  sweep += 0.04;

  // Radar background
  ctx.fillStyle="#020";
  ctx.beginPath();
  ctx.arc(150,150,140,0,Math.PI*2);
  ctx.fill();

  // Sweep arm
  const grad = ctx.createRadialGradient(150,150,0,150,150,140);
  grad.addColorStop(0,"rgba(0,255,0,0.15)");
  grad.addColorStop(1,"rgba(0,255,0,0)");
  ctx.fillStyle=grad;
  ctx.beginPath();
  ctx.moveTo(150,150);
  ctx.arc(150,150,140,sweep-0.4,sweep);
  ctx.closePath();
  ctx.fill();

  // Artifact
  if (prox>0) {
    const r = (1-prox/100)*120;
    const ax = 150 + Math.sin(dir)*r;
    const ay = 150 - Math.cos(dir)*r;

    if (Math.abs((sweep%(Math.PI*2))-dir)<0.1) {
      artifactVisible = 1;
    }

    if (artifactVisible>0) {
      ctx.fillStyle=`rgba(0,255,0,${artifactVisible})`;
      ctx.beginPath();
      ctx.arc(ax,ay,4,0,Math.PI*2);
      ctx.fill();
      artifactVisible *= 0.97;
    }
  }

  // LED & beep
  if (prox>0) {
    const interval = Math.max(60, 500 - prox*4);
    if (Date.now()-lastBeep>interval) {
      lastBeep=Date.now();
      beep.currentTime=0;
      beep.play();
      led.style.background="#f00";
      setTimeout(()=>led.style.background="#400", interval/2);
    }
  } else {
    led.style.background="#400";
  }

  // Stats
  if (prox==100) {
    statsBox.style.display="block";
    const colors = {
      Common:"#fff",
      Uncommon:"#6f6",
      Rare:"#6af",
      Legendary:"#fd6"
    };
    statsBox.style.color=colors[artifact.rarity];
    statsBox.innerHTML = `
<b>${artifact.name}</b><br>
${artifact.type}<br>
${artifact.rarity}<br>
Energy: ${artifact.energy}%<br>
Weight: ${artifact.weight}kg<br>
Rads: ${artifact.rads}<br>
Value: ${artifact.price} RU
`;
  } else {
    statsBox.style.display="none";
  }
}

draw();
</script>
</body>
</html>
